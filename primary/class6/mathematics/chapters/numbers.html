<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematics - Fractions & Decimals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
        }
        .language-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            width: 220px;
            z-index: 100;
            margin-top: 10px;
            overflow: hidden;
        }
        .language-dropdown.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        .language-option {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background 0.2s;
        }
        .language-option:hover {
            background: #f1f9ff;
        }
        .language-option.selected {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
        }
        .language-flag {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 10px;
        }
        .progress-ring {
            transition: stroke-dashoffset 0.5s ease;
        }
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        .page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }
        .option-card {
            transition: all 0.3s ease;
        }
        .option-card:hover {
            transform: translateY(-5px);
        }
        .game-card {
            transition: all 0.3s ease;
        }
        .game-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .reward-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .progress-bar-fill {
            transition: width 0.8s ease-in-out;
        }
        .achievement-unlocked {
            animation: bounce 0.6s ease;
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0, -8px, 0); }
            70% { transform: translate3d(0, -4px, 0); }
            90% { transform: translate3d(0, -2px, 0); }
        }

        /* === VIDEO LESSONS UI === */
        .video-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }
        .video-card:hover {
            transform: translateY(-2px);
        }
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 */
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .video-info {
            padding: 16px;
        }
        .video-title {
            font-weight: 600;
            color: #1e40af;
            margin: 0 0 8px;
        }
        .video-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 8px;
        }
        .video-progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 4px;
        }
        .video-progress-fill {
            height: 100%;
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.3s ease;
        }
        .completion-badge {
            display: inline-block;
            background: #dcfce7;
            color: #166534;
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 12px;
            margin-top: 6px;
        }

        /* === PDF VIEWER === */
        #pdfViewer {
            width: 100%;
            min-height: 500px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: auto;
            background: #f8fafc;
        }
        @media (max-width: 768px) {
            #pdfViewer {
                min-height: 400px;
            }
        }

        /* === XP NOTIFICATION === */
        #xpNotification {
            position: fixed;
            top: 20px;
            right: -300px;
            background: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            transition: right 0.4s ease;
        }
        #xpNotification.show {
            right: 20px;
        }
    </style>
</head>
<body class="min-h-screen pb-20">
    <!-- XP Notification -->
    <div id="xpNotification" class="xp-notification">
        <i class="fas fa-star mr-2"></i>
        <span id="xpMessage">+10 XP</span>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm py-4 sticky top-0 z-10">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <button id="backBtn" class="bg-blue-100 hover:bg-blue-200 text-blue-600 w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-xl font-bold text-blue-800" data-translate="page-title">Fractions & Decimals</h1>
            <div class="relative">
                <button id="languageBtn" class="bg-blue-100 hover:bg-blue-200 text-blue-600 w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-language"></i>
                </button>
                <div id="languageDropdown" class="language-dropdown">
                    <div class="language-option selected" data-lang="en">
                        <div class="language-flag bg-blue-600 text-white">EN</div>
                        <span>English</span>
                    </div>
                    <div class="language-option" data-lang="hi">
                        <div class="language-flag bg-orange-500 text-white">हि</div>
                        <span>हिन्दी (Hindi)</span>
                    </div>
                    <div class="language-option" data-lang="or">
                        <div class="language-flag bg-green-600 text-white">ଓଡ଼</div>
                        <span>ଓଡ଼ିଆ (Odia)</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Circle -->
    <div class="container mx-auto px-4 mt-6 flex justify-center">
        <div class="relative">
            <svg class="w-28 h-28 transform -rotate-90">
                <circle class="text-blue-100" stroke-width="10" stroke="currentColor" fill="transparent" r="50" cx="55" cy="55" />
                <circle class="progress-ring text-blue-500" stroke-width="10" stroke-dasharray="314" stroke-dashoffset="157" stroke="currentColor" fill="transparent" r="50" cx="55" cy="55" />
            </svg>
            <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span class="text-2xl font-bold text-blue-800" id="progressPercent">50%</span>
                <span class="text-xs text-blue-600" data-translate="complete">Complete</span>
            </div>
        </div>
    </div>

    <!-- Level and XP Display -->
    <div class="container mx-auto px-4 mt-4 text-center">
        <div class="inline-flex items-center bg-white rounded-full px-4 py-2 shadow-md">
            <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-star text-white text-sm"></i>
            </div>
            <span class="font-semibold text-blue-800" data-translate="level-display">Level 3 - 125 XP</span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 mt-6">
        <!-- Navigation Cards -->
        <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center text-center option-card cursor-pointer" data-target="notes">
                <div class="w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center mb-2">
                    <i class="fas fa-book-open text-blue-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-blue-800" data-translate="study-materials">Study Materials</h3>
                <p class="text-xs text-gray-600 mt-1" data-translate="learn-concepts">Learn concepts</p>
            </div>
            <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center text-center option-card cursor-pointer" data-target="rewards">
                <div class="w-14 h-14 bg-yellow-100 rounded-full flex items-center justify-center mb-2">
                    <i class="fas fa-trophy text-yellow-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-blue-800" data-translate="progress-rewards">Progress & Rewards</h3>
                <p class="text-xs text-gray-600 mt-1" data-translate="earn-achievements">Earn achievements</p>
            </div>
            <a href="maths-quiz.html">
                <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center text-center option-card cursor-pointer" data-target="quiz">
                    <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mb-2">
                        <i class="fas fa-pencil-alt text-green-600 text-xl"></i>
                    </div>
                    <h3 class="font-semibold text-blue-800" data-translate="quick-quiz">Quick Quiz</h3>
                    <p class="text-xs text-gray-600 mt-1" data-translate="test-knowledge">Test your knowledge</p>
                </div>
            </a>
            <a href="games.html">
                <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center text-center option-card cursor-pointer" data-target="games">
                    <div class="w-14 h-14 bg-purple-100 rounded-full flex items-center justify-center mb-2">
                        <i class="fas fa-gamepad text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="font-semibold text-blue-800" data-translate="interactive-games">Interactive Games</h3>
                    <p class="text-xs text-gray-600 mt-1" data-translate="learn-playing">Learn by playing</p>
                </div>
            </a>
        </div>

        <!-- Notes Page -->
        <div id="notes" class="page active">
            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                <div class="flex border-b">
                    <button class="tab-btn py-3 px-4 text-center flex-1 font-medium text-blue-800 border-b-2 border-blue-500" data-tab="videos" data-translate="video-lessons">Video Lessons</button>
                    <button class="tab-btn py-3 px-4 text-center flex-1 font-medium text-gray-500" data-tab="fractions" data-translate="fractions-tab">Fractions</button>
                    <button class="tab-btn py-3 px-4 text-center flex-1 font-medium text-gray-500" data-tab="decimals" data-translate="decimals-tab">Decimals</button>
                    <button class="tab-btn py-3 px-4 text-center flex-1 font-medium text-gray-500" data-tab="conversion" data-translate="conversion-tab">Conversion</button>
                    <button class="tab-btn py-3 px-4 text-center flex-1 font-medium text-gray-500" data-tab="pdf-notes" data-translate="pdf-notes">PDF Notes</button>
                </div>
                <div class="p-5">
                    <!-- Video Lessons -->
                    <div id="videos" class="tab-content active">
                        <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="video-lessons">Video Lessons</h2>
                        <div id="videoList" class="space-y-6"></div>
                    </div>

                    <!-- Fractions -->
                    <div id="fractions" class="tab-content">
                        <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="understanding-fractions">Understanding Fractions</h2>
                        <p class="text-gray-700 mb-4" data-translate="fraction-definition">A fraction represents a part of a whole. It consists of a numerator (top number) and a denominator (bottom number).</p>
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-semibold text-blue-700 mb-2" data-translate="types-fractions">Types of Fractions:</h3>
                            <ul class="list-disc pl-5 text-gray-700">
                                <li class="mb-2"><span class="font-medium" data-translate="proper-fractions">Proper fractions:</span> <span data-translate="proper-desc">Numerator is less than denominator (e.g., 3/4)</span></li>
                                <li class="mb-2"><span class="font-medium" data-translate="improper-fractions">Improper fractions:</span> <span data-translate="improper-desc">Numerator is greater than denominator (e.g., 5/3)</span></li>
                                <li><span class="font-medium" data-translate="mixed-numbers">Mixed numbers:</span> <span data-translate="mixed-desc">Combination of whole number and fraction (e.g., 1 ½)</span></li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-gray-700 mb-2" data-translate="example">Example:</h3>
                            <p class="text-gray-700" data-translate="pizza-example">If you have 3 out of 4 slices of pizza, you have 3/4 of the pizza.</p>
                            <p class="text-gray-700 mt-2" data-translate="adding-example">Adding fractions: 1/4 + 2/4 = 3/4 (when denominators are same)</p>
                        </div>
                    </div>

                    <!-- Decimals -->
                    <div id="decimals" class="tab-content">
                        <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="understanding-decimals">Understanding Decimals</h2>
                        <p class="text-gray-700 mb-4" data-translate="decimal-definition">Decimals are another way to represent fractions. The decimal point separates the whole number from the fractional part.</p>
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-semibold text-blue-700 mb-2" data-translate="decimal-places">Decimal Places:</h3>
                            <ul class="list-disc pl-5 text-gray-700">
                                <li class="mb-2"><span class="font-medium" data-translate="tenths">Tenths:</span> <span data-translate="tenths-desc">First digit after decimal (e.g., 0.3 = 3/10)</span></li>
                                <li class="mb-2"><span class="font-medium" data-translate="hundredths">Hundredths:</span> <span data-translate="hundredths-desc">Second digit after decimal (e.g., 0.25 = 25/100)</span></li>
                                <li><span class="font-medium" data-translate="thousandths">Thousandths:</span> <span data-translate="thousandths-desc">Third digit after decimal (e.g., 0.125 = 125/1000)</span></li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-gray-700 mb-2" data-translate="example">Example:</h3>
                            <p class="text-gray-700" data-translate="money-example">$2.50 means 2 dollars and 50 cents (50/100 of a dollar).</p>
                            <p class="text-gray-700 mt-2" data-translate="decimal-adding">Adding decimals: 1.25 + 0.75 = 2.00 (align decimal points)</p>
                        </div>
                    </div>

                    <!-- Conversion -->
                    <div id="conversion" class="tab-content">
                        <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="conversion-title">Conversion Between Fractions and Decimals</h2>
                        <p class="text-gray-700 mb-4" data-translate="conversion-desc">Converting between fractions and decimals is an important skill in mathematics.</p>
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-semibold text-blue-700 mb-2" data-translate="conversion-methods">Conversion Methods:</h3>
                            <ul class="list-disc pl-5 text-gray-700">
                                <li class="mb-2"><span class="font-medium" data-translate="frac-to-decimal">Fraction to Decimal:</span> <span data-translate="frac-to-decimal-desc">Divide numerator by denominator (e.g., 3/4 = 3 ÷ 4 = 0.75)</span></li>
                                <li><span class="font-medium" data-translate="decimal-to-frac">Decimal to Fraction:</span> <span data-translate="decimal-to-frac-desc">Write the decimal as a fraction with denominator 10, 100, 1000, etc. and simplify (e.g., 0.8 = 8/10 = 4/5)</span></li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-gray-700 mb-2" data-translate="example">Example:</h3>
                            <p class="text-gray-700" data-translate="conversion-ex1">Convert 2/5 to decimal: 2 ÷ 5 = 0.4</p>
                            <p class="text-gray-700 mt-2" data-translate="conversion-ex2">Convert 0.6 to fraction: 0.6 = 6/10 = 3/5</p>
                        </div>
                    </div>

                    <!-- PDF Notes -->
                    <div id="pdf-notes" class="tab-content">
                        <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="pdf-notes">PDF Notes</h2>
                        <a href="ncert-books-class-7-maths-chapter-2.pdf" id="downloadPdfLink" class="inline-block mb-4 text-blue-600 hover:underline" data-translate="download-pdf">
                            <i class="fas fa-download mr-1"></i> Download PDF
                        </a>
                        <div id="pdfViewer" class="bg-white border rounded-lg">
                            <p class="p-4 text-gray-600" data-translate="loading-pdf">Loading PDF...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rewards Page -->
        <div id="rewards" class="page">
            <h2 class="text-xl font-bold text-blue-800 mb-4" data-translate="progress-rewards">Progress & Rewards</h2>
            <div class="bg-white rounded-xl shadow-md p-5 mb-6">
                <h3 class="font-semibold text-blue-700 mb-4" data-translate="your-progress">Your Progress</h3>
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <p class="text-2xl font-bold text-blue-800" data-translate="level-3">Level 3</p>
                        <p class="text-sm text-gray-600" data-translate="math-explorer">Math Explorer</p>
                    </div>
                    <div class="text-right">
                        <p class="text-lg font-bold text-blue-800" id="currentXP">125 XP</p>
                        <p class="text-sm text-gray-600" data-translate="xp-next">75 XP to next level</p>
                    </div>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div class="progress-bar-fill bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full" style="width: 62%"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2" data-translate="progress-desc">Keep learning to unlock new levels!</p>
            </div>
            <div class="bg-white rounded-xl shadow-md p-5 mb-6">
                <h3 class="font-semibold text-blue-700 mb-4" data-translate="daily-streak">Daily Learning Streak</h3>
                <div class="flex items-center justify-center">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center mb-2">
                            <i class="fas fa-fire text-white text-2xl"></i>
                        </div>
                        <p class="text-2xl font-bold text-orange-600">7</p>
                        <p class="text-sm text-gray-600" data-translate="days-streak">Days Streak</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-5">
                <h3 class="font-semibold text-blue-700 mb-4" data-translate="achievements">Achievements</h3>
                <div class="space-y-4" id="achievementsList">
                    <!-- Dynamically filled -->
                </div>
            </div>
        </div>
    </main>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        // ===== TRANSLATIONS =====
        const translations = {
            en: {
                'page-title': 'Fractions & Decimals',
                'complete': 'Complete',
                'level-display': 'Level 3 - 125 XP',
                'study-materials': 'Study Materials',
                'learn-concepts': 'Learn concepts',
                'quick-quiz': 'Quick Quiz',
                'test-knowledge': 'Test your knowledge',
                'interactive-games': 'Interactive Games',
                'learn-playing': 'Learn by playing',
                'progress-rewards': 'Progress & Rewards',
                'earn-achievements': 'Earn achievements',
                'video-lessons': 'Video Lessons',
                'pdf-notes': 'PDF Notes',
                'download-pdf': 'Download PDF',
                'loading-pdf': 'Loading PDF...',
                'fractions-tab': 'Fractions',
                'decimals-tab': 'Decimals',
                'conversion-tab': 'Conversion',
                'understanding-fractions': 'Understanding Fractions',
                'fraction-definition': 'A fraction represents a part of a whole. It consists of a numerator (top number) and a denominator (bottom number).',
                'types-fractions': 'Types of Fractions:',
                'proper-fractions': 'Proper fractions:',
                'proper-desc': 'Numerator is less than denominator (e.g., 3/4)',
                'improper-fractions': 'Improper fractions:',
                'improper-desc': 'Numerator is greater than denominator (e.g., 5/3)',
                'mixed-numbers': 'Mixed numbers:',
                'mixed-desc': 'Combination of whole number and fraction (e.g., 1 ½)',
                'example': 'Example:',
                'pizza-example': 'If you have 3 out of 4 slices of pizza, you have 3/4 of the pizza.',
                'adding-example': 'Adding fractions: 1/4 + 2/4 = 3/4 (when denominators are same)',
                'understanding-decimals': 'Understanding Decimals',
                'decimal-definition': 'Decimals are another way to represent fractions. The decimal point separates the whole number from the fractional part.',
                'decimal-places': 'Decimal Places:',
                'tenths': 'Tenths:',
                'tenths-desc': 'First digit after decimal (e.g., 0.3 = 3/10)',
                'hundredths': 'Hundredths:',
                'hundredths-desc': 'Second digit after decimal (e.g., 0.25 = 25/100)',
                'thousandths': 'Thousandths:',
                'thousandths-desc': 'Third digit after decimal (e.g., 0.125 = 125/1000)',
                'money-example': '$2.50 means 2 dollars and 50 cents (50/100 of a dollar).',
                'decimal-adding': 'Adding decimals: 1.25 + 0.75 = 2.00 (align decimal points)',
                'conversion-title': 'Conversion Between Fractions and Decimals',
                'conversion-desc': 'Converting between fractions and decimals is an important skill in mathematics.',
                'conversion-methods': 'Conversion Methods:',
                'frac-to-decimal': 'Fraction to Decimal:',
                'frac-to-decimal-desc': 'Divide numerator by denominator (e.g., 3/4 = 3 ÷ 4 = 0.75)',
                'decimal-to-frac': 'Decimal to Fraction:',
                'decimal-to-frac-desc': 'Write the decimal as a fraction with denominator 10, 100, 1000, etc. and simplify (e.g., 0.8 = 8/10 = 4/5)',
                'conversion-ex1': 'Convert 2/5 to decimal: 2 ÷ 5 = 0.4',
                'conversion-ex2': 'Convert 0.6 to fraction: 0.6 = 6/10 = 3/5',
                'your-progress': 'Your Progress',
                'level-3': 'Level 3',
                'math-explorer': 'Math Explorer',
                'xp-next': '75 XP to next level',
                'progress-desc': 'Keep learning to unlock new levels!',
                'daily-streak': 'Daily Learning Streak',
                'days-streak': 'Days Streak',
                'achievements': 'Achievements',
                'first-steps': 'First Steps',
                'started-learning': 'Started learning fractions',
                'dedicated-learner': 'Dedicated Learner',
                'studied-all-topics': 'Studied all topic sections',
                'unlocked': 'Unlocked',
                'locked': 'Locked',
                'video-watcher': 'Video Watcher',
                'watched-first-video': 'Watched your first educational video'
            },
            hi: {
                'page-title': 'भिन्न और दशमलव',
                'complete': 'पूर्ण',
                'level-display': 'स्तर 3 - 125 XP',
                'study-materials': 'अध्ययन सामग्री',
                'learn-concepts': 'अवधारणाएं सीखें',
                'quick-quiz': 'त्वरित प्रश्नोत्तरी',
                'test-knowledge': 'अपने ज्ञान का परीक्षण करें',
                'interactive-games': 'इंटरैक्टिव गेम्स',
                'learn-playing': 'खेल खेल कर सीखें',
                'progress-rewards': 'प्रगति और पुरस्कार',
                'earn-achievements': 'उपलब्धियां अर्जित करें',
                'video-lessons': 'वीडियो पाठ',
                'pdf-notes': 'पीडीएफ नोट्स',
                'download-pdf': 'पीडीएफ डाउनलोड करें',
                'loading-pdf': 'पीडीएफ लोड हो रहा है...',
                'video-watcher': 'वीडियो दर्शक',
                'watched-first-video': 'अपना पहला शैक्षिक वीडियो देखा'
            },
            or: {
                'page-title': 'ଭଗ୍ନାଂଶ ଓ ଦଶମିକ',
                'complete': 'ସମ୍ପୂର୍ଣ୍ଣ',
                'level-display': 'ସ୍ତର 3 - 125 XP',
                'study-materials': 'ଅଧ୍ୟୟନ ସାମଗ୍ରୀ',
                'learn-concepts': 'ଧାରଣା ଶିଖନ୍ତୁ',
                'quick-quiz': 'ତ୍ୱରିତ କୁଇଜ୍',
                'test-knowledge': 'ନିଜ ଜ୍ଞାନ ପରୀକ୍ଷା କରନ୍ତୁ',
                'interactive-games': 'ଇଣ୍ଟରାକ୍ଟିଭ୍ ଖେଳ',
                'learn-playing': 'ଖେଳ ମାଧ୍ୟମରେ ଶିଖନ୍ତୁ',
                'progress-rewards': 'ପ୍ରଗତି ଓ ପୁରସ୍କାର',
                'earn-achievements': 'ସଫଳତା ଅର୍ଜନ କରନ୍ତୁ',
                'video-lessons': 'ଭିଡିଓ ପାଠ',
                'pdf-notes': 'PDF ନୋଟ୍ସ',
                'download-pdf': 'PDF ଡାଉନଲୋଡ୍ କରନ୍ତୁ',
                'loading-pdf': 'PDF ଲୋଡ୍ ହେଉଛି...',
                'video-watcher': 'ଭିଡିଓ ଦର୍ଶକ',
                'watched-first-video': 'ଆପଣଙ୍କ ପ୍ରଥମ ଶିକ୍ଷାମୂଳକ ଭିଡିଓ ଦେଖିଲେ'
            }
        };

        // ===== STATE =====
        let currentLanguage = 'en';
        let currentProgress = 50;
        let currentXP = 125;
        let pdfAccessed = JSON.parse(localStorage.getItem('pdfAccessed')) || false;
        let achievements = JSON.parse(localStorage.getItem('achievements')) || {
            'first-steps': true,
            'dedicated-learner': true,
            'video-watcher': false
        };
        let videoCompletion = JSON.parse(localStorage.getItem('videoCompletion')) || {};
        let players = {};

        // Configure your YouTube videos here
        const videoLessons = [
            { id: 'v1', youtubeId: '7E7zoa4Xj4Y', title: 'Introduction to Fractions', duration: '8:42' },
            { id: 'v2', youtubeId: 'aaFk1h6eI7E', title: 'Understanding Decimals', duration: '10:15' },
            { id: 'v3', youtubeId: 'kWtR3d2N0qY', title: 'Fraction to Decimal Conversion', duration: '7:30' }
        ];

        videoLessons.forEach(v => {
            if (videoCompletion[v.id] === undefined) videoCompletion[v.id] = 0;
        });

        // ===== UTILITIES =====
        function translatePage(lang) {
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(el => {
                const key = el.getAttribute('data-translate');
                if (translations[lang][key]) el.textContent = translations[lang][key];
            });
            currentLanguage = lang;
            renderAchievements();
        }

        function updateProgress(p) {
            const ring = document.querySelector('.progress-ring');
            const percent = document.getElementById('progressPercent');
            const r = 50;
            const c = 2 * Math.PI * r;
            currentProgress = p;
            ring.style.strokeDasharray = `${c} ${c}`;
            ring.style.strokeDashoffset = `${c - (p / 100) * c}`;
            percent.textContent = `${p}%`;
        }

        function showXPNotification(xp) {
            const notif = document.getElementById('xpNotification');
            document.getElementById('xpMessage').textContent = `+${xp} XP`;
            notif.classList.add('show');
            setTimeout(() => notif.classList.remove('show'), 3000);
        }

        function addXP(amount) {
            currentXP += amount;
            document.getElementById('currentXP').textContent = `${currentXP} XP`;
            showXPNotification(amount);
            const level = Math.floor(currentXP / 100) + 1;
            document.querySelector('[data-translate="level-display"]').textContent = `Level ${level} - ${currentXP} XP`;
            saveProgress();
        }

        function saveProgress() {
            localStorage.setItem('mathAppProgress', JSON.stringify({
                progress: currentProgress,
                xp: currentXP,
                achievements,
                videoCompletion,
                pdfAccessed
            }));
        }

        function loadProgress() {
            const saved = localStorage.getItem('mathAppProgress');
            if (saved) {
                const data = JSON.parse(saved);
                currentProgress = data.progress || 50;
                currentXP = data.xp || 125;
                if (data.achievements) Object.assign(achievements, data.achievements);
                if (data.videoCompletion) Object.assign(videoCompletion, data.videoCompletion);
                pdfAccessed = data.pdfAccessed || false;
                updateProgress(currentProgress);
                document.getElementById('currentXP').textContent = `${currentXP} XP`;
            }
        }

        // ===== VIDEO SYSTEM =====
        function renderVideoList() {
            const container = document.getElementById('videoList');
            if (!container) return;
            container.innerHTML = '';
            videoLessons.forEach(v => {
                const pct = videoCompletion[v.id] || 0;
                const done = pct >= 100;
                const badge = done ? `<span class="completion-badge">✓ ${translations[currentLanguage]['unlocked']}</span>` : '';
                container.innerHTML += `
                    <div class="video-card">
                        <div class="video-container">
                            <iframe id="player-${v.id}" 
                                src="https://www.youtube.com/embed/${v.youtubeId}?enablejsapi=1&origin=${window.location.origin}"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">${v.title}</h3>
                            <div class="video-meta">
                                <span>${v.duration}</span>
                                <span>${Math.round(pct)}% ${translations[currentLanguage]['complete'].toLowerCase()}</span>
                            </div>
                            <div class="video-progress-bar">
                                <div class="video-progress-fill" id="progress-${v.id}" style="width: ${pct}%"></div>
                            </div>
                            ${badge}
                        </div>
                    </div>
                `;
            });
        }

        function onYouTubeIframeAPIReady() {
            videoLessons.forEach(v => {
                players[v.id] = new YT.Player(`player-${v.id}`, {
                    events: {
                        'onStateChange': function(event) {
                            if (event.data === YT.PlayerState.PLAYING) {
                                const check = () => {
                                    if (!players[v.id] || players[v.id].getPlayerState() !== YT.PlayerState.PLAYING) return;
                                    const dur = players[v.id].getDuration();
                                    const cur = players[v.id].getCurrentTime();
                                    if (dur > 0) {
                                        let pct = (cur / dur) * 100;
                                        if (pct > 100) pct = 100;
                                        videoCompletion[v.id] = pct;
                                        saveProgress();
                                        const fill = document.getElementById(`progress-${v.id}`);
                                        if (fill) fill.style.width = `${pct}%`;
                                        const meta = document.querySelector(`#player-${v.id}`).closest('.video-card').querySelector('.video-meta span:last-child');
                                        if (meta) meta.textContent = `${Math.round(pct)}% ${translations[currentLanguage]['complete'].toLowerCase()}`;
                                        if (pct >= 100 && !document.querySelector(`#progress-${v.id}`).dataset.completed) {
                                            document.querySelector(`#progress-${v.id}`).dataset.completed = 'true';
                                            addXP(10);
                                            if (!achievements['video-watcher']) {
                                                achievements['video-watcher'] = true;
                                                renderAchievements();
                                            }
                                            renderVideoList();
                                        }
                                    }
                                    setTimeout(check, 2000);
                                };
                                check();
                            }
                        }
                    }
                });
            });
        }

        // ===== PDF SYSTEM =====
        function loadPDF() {
            if (pdfAccessed) return;
            const viewer = document.getElementById('pdfViewer');
            if (!viewer) return;

            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
            script.onload = () => {
                const pdfjsLib = window['pdfjs-dist/build/pdf'];
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

                // 👇 REPLACE THIS PATH WITH YOUR PDF FILE
                const pdfUrl = 'ncert-books-class-7-maths-chapter-2.pdf';

                pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
                    pdf.getPage(1).then(page => {
                        const scale = Math.min(window.innerWidth / page.getViewport({ scale: 1 }).width, 1.5);
                        const viewport = page.getViewport({ scale });
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.height = viewport.height;
                        canvas.width = viewport.width;
                        viewer.innerHTML = '';
                        viewer.appendChild(canvas);
                        page.render({ canvasContext: ctx, viewport });

                        if (!pdfAccessed) {
                            pdfAccessed = true;
                            addXP(5);
                            saveProgress();
                        }
                    });
                }).catch(err => {
                    viewer.innerHTML = '<p class="p-4 text-red-500">Failed to load PDF.</p>';
                });
            };
            document.head.appendChild(script);
        }

        // ===== ACHIEVEMENTS =====
        function renderAchievements() {
            const list = document.getElementById('achievementsList');
            if (!list) return;
            const ach = [
                { id: 'first-steps', title: 'first-steps', desc: 'started-learning', icon: 'fa-star', color: 'from-yellow-400 to-orange-500' },
                { id: 'dedicated-learner', title: 'dedicated-learner', desc: 'studied-all-topics', icon: 'fa-book-reader', color: 'from-green-400 to-blue-500' },
                { id: 'video-watcher', title: 'video-watcher', desc: 'watched-first-video', icon: 'fa-video', color: 'from-purple-400 to-pink-500' }
            ];
            list.innerHTML = '';
            ach.forEach(a => {
                const unlocked = achievements[a.id];
                const bg = unlocked ? `bg-gradient-to-br ${a.color}` : 'bg-gray-300';
                const txt = unlocked ? 'text-blue-800' : 'text-gray-600';
                const status = unlocked ? translations[currentLanguage]['unlocked'] : translations[currentLanguage]['locked'];
                const cls = unlocked ? 'bg-green-100 text-green-800' : 'bg-gray-200 text-gray-600';
                const ic = unlocked ? 'text-white' : 'text-gray-500';
                list.innerHTML += `
                    <div class="flex items-center p-3 ${unlocked ? 'bg-blue-50 achievement-unlocked' : 'bg-gray-50'} rounded-lg">
                        <div class="w-12 h-12 rounded-full ${bg} flex items-center justify-center mr-4 ${unlocked ? 'reward-badge' : ''}">
                            <i class="fas ${a.icon} ${ic} text-xl"></i>
                        </div>
                        <div>
                            <h4 class="font-medium ${txt}" data-translate="${a.title}">${translations[currentLanguage][a.title]}</h4>
                            <p class="text-sm ${unlocked ? 'text-gray-600' : 'text-gray-500'}" data-translate="${a.desc}">${translations[currentLanguage][a.desc]}</p>
                        </div>
                        <div class="ml-auto">
                            <span class="${cls} text-xs px-2 py-1 rounded-full">${status}</span>
                        </div>
                    </div>
                `;
            });
        }

        // ===== DOM READY =====
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            updateProgress(currentProgress);
            renderAchievements();

            // Render video list
            renderVideoList();

            // Language
            document.getElementById('languageBtn').addEventListener('click', e => {
                e.stopPropagation();
                document.getElementById('languageDropdown').classList.toggle('active');
            });
            document.addEventListener('click', () => document.getElementById('languageDropdown').classList.remove('active'));
            document.querySelectorAll('.language-option').forEach(opt => {
                opt.addEventListener('click', () => {
                    const lang = opt.getAttribute('data-lang');
                    document.querySelectorAll('.language-option').forEach(o => o.classList.remove('selected'));
                    opt.classList.add('selected');
                    translatePage(lang);
                    document.getElementById('languageDropdown').classList.remove('active');
                });
            });

            // Navigation
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', () => {
                    const t = card.getAttribute('data-target');
                    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                    document.getElementById(t).classList.add('active');
                    addXP(2);
                });
            });
            document.getElementById('backBtn').addEventListener('click', () => {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById('notes').classList.add('active');
            });

            // Tabs
            document.addEventListener('click', e => {
                if (e.target.classList.contains('tab-btn')) {
                    document.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('text-blue-800', 'border-blue-500');
                        b.classList.add('text-gray-500');
                    });
                    e.target.classList.add('text-blue-800', 'border-blue-500');
                    e.target.classList.remove('text-gray-500');

                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    const id = e.target.getAttribute('data-tab');
                    document.getElementById(id).classList.add('active');

                    if (id === 'videos') renderVideoList();
                    if (id === 'pdf-notes') loadPDF();

                    addXP(1);
                }
            });

            // PDF Download XP
            document.getElementById('downloadPdfLink').addEventListener('click', () => {
                if (!pdfAccessed) {
                    pdfAccessed = true;
                    addXP(5);
                    saveProgress();
                }
            });
        });
    </script>
</body>
</html>